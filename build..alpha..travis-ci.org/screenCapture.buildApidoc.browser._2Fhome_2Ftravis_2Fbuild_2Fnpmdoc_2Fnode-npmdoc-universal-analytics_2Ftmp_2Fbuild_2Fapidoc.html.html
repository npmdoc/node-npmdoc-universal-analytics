<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/peaksandpies/universal-analytics#readme">universal-analytics (v0.4.13)</a>
</h1>
<h4>A node module for Google's Universal Analytics tracking</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.universal-analytics">module universal-analytics</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor">
            function <span class="apidocSignatureSpan">universal-analytics.</span>Visitor
            <span class="apidocSignatureSpan">(tid, cid, options, context, persistentParams)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.createFromSession">
            function <span class="apidocSignatureSpan">universal-analytics.</span>createFromSession
            <span class="apidocSignatureSpan">(session)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.middleware">
            function <span class="apidocSignatureSpan">universal-analytics.</span>middleware
            <span class="apidocSignatureSpan">(tid, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">universal-analytics.</span>Visitor.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">universal-analytics.</span>utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.universal-analytics.Visitor">module universal-analytics.Visitor</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.Visitor">
            function <span class="apidocSignatureSpan">universal-analytics.</span>Visitor
            <span class="apidocSignatureSpan">(tid, cid, options, context, persistentParams)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.universal-analytics.Visitor.prototype">module universal-analytics.Visitor.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype._checkParameters">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_checkParameters
            <span class="apidocSignatureSpan">(params)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype._determineCid">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_determineCid
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype._enqueue">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_enqueue
            <span class="apidocSignatureSpan">(type, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype._handleError">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_handleError
            <span class="apidocSignatureSpan">(message, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype._log">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_log
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype._tidyParameters">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_tidyParameters
            <span class="apidocSignatureSpan">(params)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype._translateParams">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_translateParams
            <span class="apidocSignatureSpan">(params)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype._withContext">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_withContext
            <span class="apidocSignatureSpan">(context)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.debug">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>debug
            <span class="apidocSignatureSpan">(debug)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.e">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>e
            <span class="apidocSignatureSpan">(category, action, label, value, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.event">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>event
            <span class="apidocSignatureSpan">(category, action, label, value, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.exception">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>exception
            <span class="apidocSignatureSpan">(description, fatal, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.i">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>i
            <span class="apidocSignatureSpan">(price, quantity, sku, name, variation, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.item">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>item
            <span class="apidocSignatureSpan">(price, quantity, sku, name, variation, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.pageview">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>pageview
            <span class="apidocSignatureSpan">(path, hostname, title, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.pv">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>pv
            <span class="apidocSignatureSpan">(path, hostname, title, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.reset">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>reset
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.screenview">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>screenview
            <span class="apidocSignatureSpan">(screenName, appName, appVersion, appId, appInstallerId, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.send">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>send
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.set">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>set
            <span class="apidocSignatureSpan">(key, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.t">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>t
            <span class="apidocSignatureSpan">(transaction, revenue, shipping, tax, affiliation, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.timing">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>timing
            <span class="apidocSignatureSpan">(category, variable, time, label, params, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.Visitor.prototype.transaction">
            function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>transaction
            <span class="apidocSignatureSpan">(transaction, revenue, shipping, tax, affiliation, params, fn)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.universal-analytics.utils">module universal-analytics.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.utils.ensureValidCid">
            function <span class="apidocSignatureSpan">universal-analytics.utils.</span>ensureValidCid
            <span class="apidocSignatureSpan">(uuid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.utils.isCookieCid">
            function <span class="apidocSignatureSpan">universal-analytics.utils.</span>isCookieCid
            <span class="apidocSignatureSpan">(cid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.universal-analytics.utils.isUuid">
            function <span class="apidocSignatureSpan">universal-analytics.utils.</span>isUuid
            <span class="apidocSignatureSpan">(uuid)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.universal-analytics" id="apidoc.module.universal-analytics">module universal-analytics</a></h1>


    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor" id="apidoc.element.universal-analytics.Visitor">
        function <span class="apidocSignatureSpan">universal-analytics.</span>Visitor
        <span class="apidocSignatureSpan">(tid, cid, options, context, persistentParams)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Visitor = function (tid, cid, options, context, persistentParams) {

  if (typeof tid === 'object') {
    options = tid;
    tid = cid = null;
  } else if (typeof cid === 'object') {
    options = cid;
    cid = null;
  }

  this._queue = [];

  this.options = options || {};

  if(this.options.hostname) {
    config.hostname = this.options.hostname;
  }
  if(this.options.path) {
    config.path = this.options.path;
  }

  if (this.options.https) {
    var parsedHostname = url.parse(config.hostname);
    config.hostname = 'https://' + parsedHostname.host;
  }

  if(this.options.enableBatching !== undefined) {
    config.batching = options.enableBatching;
  }

  if(this.options.batchSize) {
    config.batchSize = this.options.batchSize;
  }

  this._context = context || {};
  this._persistentParams = persistentParams ||Â&nbsp;{};

  this.tid = tid || this.options.tid;
  this.cid = this._determineCid(cid, this.options.cid, (this.options.strictCidFormat !== false));
  if(this.options.uid) {
    this.uid = this.options.uid;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.createFromSession" id="apidoc.element.universal-analytics.createFromSession">
        function <span class="apidocSignatureSpan">universal-analytics.</span>createFromSession
        <span class="apidocSignatureSpan">(session)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createFromSession = function (session) {
  if (session &amp;&amp; session.cid) {
    return init(this.tid, session.cid, this.options);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

The middleware will attach the `universal analytics` visitor instance to every request (`req.visitor`).

Additionally, the module also exposes a `createFromSession` method to create a visitor instance simply based on a session, which
 is helpful when working with Socket.io, etc. where the middleware is not used.

```javascript
var visitor = ua.<span class="apidocCodeKeywordSpan">createFromSession</span>(socket.handshake.session);
```

# Debug mode

`universal-analytics` can be instructed to output information during tracking by enabling the debug mode:

```javascript
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.middleware" id="apidoc.element.universal-analytics.middleware">
        function <span class="apidocSignatureSpan">universal-analytics.</span>middleware
        <span class="apidocSignatureSpan">(tid, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (tid, options) {

  this.tid = tid;
  this.options = options;

  var cookieName = (this.options || {}).cookieName ||Â&nbsp;"_ga";

  return function (req, res, next) {

    req.visitor = module.exports.createFromSession(req.session);

    if (req.visitor) return next();

    var cid;
    if (req.cookies &amp;&amp; req.cookies[cookieName]) {
      var gaSplit = req.cookies[cookieName].split('.');
      cid = gaSplit[2] + "." + gaSplit[3];
    }

    req.visitor = init(tid, cid, options);

    if (req.session) {
      req.session.cid = req.visitor.cid;
    }

    next();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

```javascript
var ua = require("universal-analytics");
var express = require("express");

var app = express()

express.use(ua.<span class="apidocCodeKeywordSpan">middleware</span>("UA-XXXX-Y", {cookieName: '_ga'}));
```

The middleware will attach the `universal analytics` visitor instance to every request (`req.visitor`).

Additionally, the module also exposes a `createFromSession` method to create a visitor instance simply based on a session, which
 is helpful when working with Socket.io, etc. where the middleware is not used.

```javascript
...</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.universal-analytics.Visitor" id="apidoc.module.universal-analytics.Visitor">module universal-analytics.Visitor</a></h1>


    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.Visitor" id="apidoc.element.universal-analytics.Visitor.Visitor">
        function <span class="apidocSignatureSpan">universal-analytics.</span>Visitor
        <span class="apidocSignatureSpan">(tid, cid, options, context, persistentParams)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Visitor = function (tid, cid, options, context, persistentParams) {

  if (typeof tid === 'object') {
    options = tid;
    tid = cid = null;
  } else if (typeof cid === 'object') {
    options = cid;
    cid = null;
  }

  this._queue = [];

  this.options = options || {};

  if(this.options.hostname) {
    config.hostname = this.options.hostname;
  }
  if(this.options.path) {
    config.path = this.options.path;
  }

  if (this.options.https) {
    var parsedHostname = url.parse(config.hostname);
    config.hostname = 'https://' + parsedHostname.host;
  }

  if(this.options.enableBatching !== undefined) {
    config.batching = options.enableBatching;
  }

  if(this.options.batchSize) {
    config.batchSize = this.options.batchSize;
  }

  this._context = context || {};
  this._persistentParams = persistentParams ||Â&nbsp;{};

  this.tid = tid || this.options.tid;
  this.cid = this._determineCid(cid, this.options.cid, (this.options.strictCidFormat !== false));
  if(this.options.uid) {
    this.uid = this.options.uid;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.universal-analytics.Visitor.prototype" id="apidoc.module.universal-analytics.Visitor.prototype">module universal-analytics.Visitor.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype._checkParameters" id="apidoc.element.universal-analytics.Visitor.prototype._checkParameters">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_checkParameters
        <span class="apidocSignatureSpan">(params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_checkParameters = function (params) {
  for (var param in params) {
    if (config.acceptedParameters.indexOf(param) !== -1 || config.acceptedParametersRegex.filter(function (r) {
        return r.test(param);
      }).length) {
      continue;
    }
    this._log("Warning! Unsupported tracking parameter " + param + " (" + params[param] + ")");
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype._determineCid" id="apidoc.element.universal-analytics.Visitor.prototype._determineCid">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_determineCid
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_determineCid = function () {
  var args = Array.prototype.splice.call(arguments, 0);
  var id;
  var lastItem = args.length-1;
  var strict = args[lastItem];
  if (strict) {
    for (var i = 0; i &lt; lastItem; i++) {
      id = utils.ensureValidCid(args[i]);
      if (id !== false) return id;
      if (id != null) this._log("Warning! Invalid UUID format '" + args[i] + "'");
    }
  } else {
    for (var i = 0; i &lt; lastItem; i++) {
      if (args[i]) return args[i];
    }
  }
  return uuid.v4();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype._enqueue" id="apidoc.element.universal-analytics.Visitor.prototype._enqueue">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_enqueue
        <span class="apidocSignatureSpan">(type, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_enqueue = function (type, params, fn) {

  if (typeof params === 'function') {
    fn = params;
    params = {};
  }

  params = this._translateParams(params) || {};

  _.extend(params, {
    v: config.protocolVersion,
    tid: this.tid,
    cid: this.cid,
    t: type
  });
  if(this.uid) {
    params.uid = this.uid;
  }

  this._queue.push(params);

  if (this.options.debug) {
    this._checkParameters(params);
  }

  this._log("Enqueued " + type + " (" + JSON.stringify(params) + ")");

  if (fn) {
    this.send(fn);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype._handleError" id="apidoc.element.universal-analytics.Visitor.prototype._handleError">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_handleError
        <span class="apidocSignatureSpan">(message, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handleError = function (message, fn) {
    this._log("Error: " + message)
    fn &amp;&amp; fn.call(this, new Error(message))
    return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype._log" id="apidoc.element.universal-analytics.Visitor.prototype._log">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_log
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_log = function (message) {
  this.options.debug &amp;&amp; console.log("[universal-analytics] " + message);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype._tidyParameters" id="apidoc.element.universal-analytics.Visitor.prototype._tidyParameters">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_tidyParameters
        <span class="apidocSignatureSpan">(params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_tidyParameters = function (params) {
  for (var param in params) {
    if (params[param] === null || params[param] === undefined) {
      delete params[param];
    }
  }
  return params;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype._translateParams" id="apidoc.element.universal-analytics.Visitor.prototype._translateParams">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_translateParams
        <span class="apidocSignatureSpan">(params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_translateParams = function (params) {
    var translated = {};
    for (var key in params) {
        if (config.parametersMap.hasOwnProperty(key)) {
            translated[config.parametersMap[key]] = params[key];
        } else {
            translated[key] = params[key];
        }
    }
    return translated;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype._withContext" id="apidoc.element.universal-analytics.Visitor.prototype._withContext">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>_withContext
        <span class="apidocSignatureSpan">(context)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_withContext = function (context) {
  var visitor = new Visitor(this.tid, this.cid, this.options, context, this._persistentParams);
  visitor._queue = this._queue;
  return visitor;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.debug" id="apidoc.element.universal-analytics.Visitor.prototype.debug">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>debug
        <span class="apidocSignatureSpan">(debug)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">debug = function (debug) {
  this.options.debug = arguments.length === 0 ? true : debug;
  this._log("Logging enabled")
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

# Debug mode

`universal-analytics` can be instructed to output information during tracking by enabling the debug mode:

```javascript
var visitor = ua("UA-XXXX-XX").<span class="apidocCodeKeywordSpan">debug</span>()
// â€¦ and so forth.
```


# Request Options

In order to add additional options to the request a `requestOptions` hash can be provided as part of the constructor options. `unviversal
-analytics` uses the [`request`](https://www.npmjs.com/package/request) library. Therefor [any option available for that library
](https://www.npmjs.com/package/request#requestoptions-callback) can be provided via the `requestOptions`.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.e" id="apidoc.element.universal-analytics.Visitor.prototype.e">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>e
        <span class="apidocSignatureSpan">(category, action, label, value, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">e = function (category, action, label, value, params, fn) {

  if (typeof category === 'object' &amp;&amp; category != null) {
    params = category;
    if (typeof action === 'function') {
      fn = action
    }
    category = action = label = value = null;
  } else if (typeof label === 'function') {
    fn = label;
    label = value = null;
  } else if (typeof value === 'function') {
    fn = value;
    value = null;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.ec = category || params.ec || this._context.ec;
  params.ea = action || params.ea || this._context.ea;
  params.el = label || params.el || this._context.el;
  params.ev = value || params.ev || this._context.ev;
  params.p = params.p || params.dp || this._context.p || this._context.dp;

  delete params.dp;
  this._tidyParameters(params);

  if (!params.ec || !params.ea) {
    return this._handleError("Please provide at least an event category (ec) and an event action (ea)", fn);
  }

  return this._withContext(params)._enqueue("event", params, fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.event" id="apidoc.element.universal-analytics.Visitor.prototype.event">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>event
        <span class="apidocSignatureSpan">(category, action, label, value, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">event = function (category, action, label, value, params, fn) {

  if (typeof category === 'object' &amp;&amp; category != null) {
    params = category;
    if (typeof action === 'function') {
      fn = action
    }
    category = action = label = value = null;
  } else if (typeof label === 'function') {
    fn = label;
    label = value = null;
  } else if (typeof value === 'function') {
    fn = value;
    value = null;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.ec = category || params.ec || this._context.ec;
  params.ea = action || params.ea || this._context.ea;
  params.el = label || params.el || this._context.el;
  params.ev = value || params.ev || this._context.ev;
  params.p = params.p || params.dp || this._context.p || this._context.dp;

  delete params.dp;
  this._tidyParameters(params);

  if (!params.ec || !params.ea) {
    return this._handleError("Please provide at least an event category (ec) and an event action (ea)", fn);
  }

  return this._withContext(params)._enqueue("event", params, fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

## Event tracking


Tracking events with `universal-analytics` works like pageview tracking, only you have to provide different arguments:

```javascript
visitor.<span class="apidocCodeKeywordSpan">event</span>("Event Category", "Event Action").send()
```

This is the most straightforward way to track an event. The event attributes *label* and *value* are optional and can be provided
 if necessary:

```javascript
visitor.event("Event Category", "Event Action", "â€¦and a label", 42).send()
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.exception" id="apidoc.element.universal-analytics.Visitor.prototype.exception">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>exception
        <span class="apidocSignatureSpan">(description, fatal, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exception = function (description, fatal, params, fn) {

  if (typeof description === 'object') {
    params = description;
    if (typeof fatal === 'function') {
      fn = fatal;
    }
    description = fatal = null;
  } else if (typeof fatal === 'function') {
    fn = fatal;
    fatal = 0;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.exd = description || params.exd || this._context.exd;
  params.exf = +!!(fatal || params.exf || this._context.exf);

  if (params.exf === 0) {
    delete params.exf;
  }

  this._tidyParameters(params);

  return this._withContext(params)._enqueue("exception", params, fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


## Exception tracking

Exception tracking is a way to keep track of any sort of application errors and bugs with Google Analytics. Using it with this module
 is a way to capture server-side problems.

```javascript
visitor.<span class="apidocCodeKeywordSpan">exception</span>("StackOverflow Error").send()
```

As an additional information, the exception can be flagged as fatal if the error was exceptionally bad.

```javascript
var fatal = true;
visitor.exception("StackOverflow Error", fatal, function () {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.i" id="apidoc.element.universal-analytics.Visitor.prototype.i">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>i
        <span class="apidocSignatureSpan">(price, quantity, sku, name, variation, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">i = function (price, quantity, sku, name, variation, params, fn) {
  if (typeof price === 'object') {
    params = price;
    if (typeof quantity === 'function') {
      fn = quantity
    }
    price = quantity = sku = name = variation = null;
  } else if (typeof quantity === 'function') {
    fn = quantity;
    quantity = sku = name = variation = null;
  } else if (typeof sku === 'function') {
    fn = sku;
    sku = name = variation = null;
  } else if (typeof name === 'function') {
    fn = name;
    name = variation = null;
  } else if (typeof variation === 'function') {
    fn = variation;
    variation = null;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.ip = price || params.ip || this._context.ip;
  params.iq = quantity || params.iq || this._context.iq;
  params.ic = sku || params.ic || this._context.ic;
  params.in = name || params.in || this._context.in;
  params.iv = variation || params.iv || this._context.iv;
  params.p = params.p || this._context.p || this._context.dp;
  params.ti = params.ti || this._context.ti;

  this._tidyParameters(params);

  if (!params.ti) {
    return this._handleError("Please provide at least an item transaction ID (ti)", fn);
  }

  return this._withContext(params)._enqueue("item", params, fn);

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.item" id="apidoc.element.universal-analytics.Visitor.prototype.item">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>item
        <span class="apidocSignatureSpan">(price, quantity, sku, name, variation, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">item = function (price, quantity, sku, name, variation, params, fn) {
  if (typeof price === 'object') {
    params = price;
    if (typeof quantity === 'function') {
      fn = quantity
    }
    price = quantity = sku = name = variation = null;
  } else if (typeof quantity === 'function') {
    fn = quantity;
    quantity = sku = name = variation = null;
  } else if (typeof sku === 'function') {
    fn = sku;
    sku = name = variation = null;
  } else if (typeof name === 'function') {
    fn = name;
    name = variation = null;
  } else if (typeof variation === 'function') {
    fn = variation;
    variation = null;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.ip = price || params.ip || this._context.ip;
  params.iq = quantity || params.iq || this._context.iq;
  params.ic = sku || params.ic || this._context.ic;
  params.in = name || params.in || this._context.in;
  params.iv = variation || params.iv || this._context.iv;
  params.p = params.p || this._context.p || this._context.dp;
  params.ti = params.ti || this._context.ti;

  this._tidyParameters(params);

  if (!params.ti) {
    return this._handleError("Please provide at least an item transaction ID (ti)", fn);
  }

  return this._withContext(params)._enqueue("item", params, fn);

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
## E-commerce tracking

E-commerce tracking in general is a bit more complex. It requires a combination of one call to the `transaction()` method and one
 or more calls to the `item()` method.

```javascript
visitor
  .transaction("trans-12345", 500)   // Create transaction trans-12345 worth 500 total.
  .<span class="apidocCodeKeywordSpan">item</span>(300, 1, "item-54321")        // Add 1 unit the item item-54321 worth
 300.
  .item(200, 2, "item-41325")        // Add 2 units the item item-41325 worth 200.
  .send()
```

Once again, daisy-chaining simplifies associating the items with the transaction. Officially, nothing but the transaction ID is
a requirement for both the transaction and the items. However, providing a minimum set of information (revenue for the transaction
, price, quantity and ID for the items) is recommended.

It is also possible to provide the params as an object to both methods:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.pageview" id="apidoc.element.universal-analytics.Visitor.prototype.pageview">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>pageview
        <span class="apidocSignatureSpan">(path, hostname, title, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pageview = function (path, hostname, title, params, fn) {

  if (typeof path === 'object' &amp;&amp; path != null) {
    params = path;
    if (typeof hostname === 'function') {
      fn = hostname
    }
    path = hostname = title  = null;
  } else if (typeof hostname === 'function') {
    fn = hostname
    hostname = title = null;
  } else if (typeof title === 'function') {
    fn = title;
    title = null;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.dp = path || params.dp || this._context.dp;
  params.dh = hostname || params.dh || this._context.dh;
  params.dt = title || params.dt || this._context.dt;

  this._tidyParameters(params);

  if (!params.dp &amp;&amp; !params.dl) {
    return this._handleError("Please provide either a page path (dp) or a document location (dl)", fn);
  }

  return this._withContext(params)._enqueue("pageview", params, fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```javascript
var visitor = ua('UA-XXXX-XX', {https: true});
```

Tracking a pageview without much else is now very simple:

```javascript
visitor.<span class="apidocCodeKeywordSpan">pageview</span>("/").send()
```

The first argument for the pageview method is the path of the page to be tracked. Simply calling `pageview()` will not initiate
a tracking request. In order to send off tracking to the Google Analytics servers you have two options:

1. You can append a `send()` call after `pageview()`. The tracking request is sent asynchronously. This means you will not receive
 any confirmation when and if it was successful.
2. You can provide a callback function to `pageview()` as an additional, last argument. This callback will be invoked once the tracking
 request has finished. Any error that occured during the request will be provided to said callback. In that case `send()` is no
longer necessary.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.pv" id="apidoc.element.universal-analytics.Visitor.prototype.pv">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>pv
        <span class="apidocSignatureSpan">(path, hostname, title, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pv = function (path, hostname, title, params, fn) {

  if (typeof path === 'object' &amp;&amp; path != null) {
    params = path;
    if (typeof hostname === 'function') {
      fn = hostname
    }
    path = hostname = title  = null;
  } else if (typeof hostname === 'function') {
    fn = hostname
    hostname = title = null;
  } else if (typeof title === 'function') {
    fn = title;
    title = null;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.dp = path || params.dp || this._context.dp;
  params.dh = hostname || params.dh || this._context.dh;
  params.dt = title || params.dt || this._context.dt;

  this._tidyParameters(params);

  if (!params.dp &amp;&amp; !params.dl) {
    return this._handleError("Please provide either a page path (dp) or a document location (dl)", fn);
  }

  return this._withContext(params)._enqueue("pageview", params, fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.reset" id="apidoc.element.universal-analytics.Visitor.prototype.reset">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>reset
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reset = function () {
  this._context = null;
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.screenview" id="apidoc.element.universal-analytics.Visitor.prototype.screenview">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>screenview
        <span class="apidocSignatureSpan">(screenName, appName, appVersion, appId, appInstallerId, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">screenview = function (screenName, appName, appVersion, appId, appInstallerId, params, fn) {

    if (typeof screenName === 'object' &amp;&amp; screenName != null) {
        params = screenName;
        if (typeof appName === 'function') {
            fn = appName
        }
        screenName = appName = appVersion = appId = appInstallerId = null;
    } else if (typeof appName === 'function') {
        fn = appName
        appName = appVersion = appId = appInstallerId = null;
    } else if (typeof appVersion === 'function') {
        fn = appVersion;
        appVersion = appId = appInstallerId = null;
    } else if (typeof appId === 'function') {
        fn = appId;
        appId = appInstallerId = null;
    } else if (typeof appInstallerId === 'function') {
        fn = appInstallerId;
        appInstallerId = null;
    } else if (typeof params === 'function') {
        fn = params;
        params = null;
    }

    params = this._translateParams(params);

    params = _.extend({}, this._persistentParams || {}, params);

    params.cd = screenName || params.cd || this._context.cd;
    params.an = appName || params.an || this._context.an;
    params.av = appVersion || params.av || this._context.av;
    params.aid = appId || params.aid || this._context.aid;
    params.aiid = appInstallerId || params.aiid || this._context.aiid;

    this._tidyParameters(params);

    if (!params.cd || !params.an) {
        return this._handleError("Please provide at least a screen name (cd) and an app name (an)", fn);
    }

    return this._withContext(params)._enqueue("screenview", params, fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


## Screenview tracking

Instead of pageviews app will want to track screenviews.

```javascript
visitor.<span class="apidocCodeKeywordSpan">screenview</span>("Home Screen", "App Name").send()
```

The following method signatures are available for #screenview:

* `Visitor#screenview(screenName, appName)`
* `Visitor#screenview(screenName, appName, callback)`
* `Visitor#screenview(screenName, appName, appVersion)`
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.send" id="apidoc.element.universal-analytics.Visitor.prototype.send">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>send
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (fn) {
  var self = this;
  var count = 1;
  var fn = fn || function () {};
  self._log("Sending " + self._queue.length + " tracking call(s)");

  var test = function () {
    return self._queue.length &gt; 0;
  }

  var getBody = function(params) {
    return params.map(function(x) { return querystring.stringify(x); }).join("\n");
  }

  var iterator = function (fn) {
    var params = [];

    if(config.batching) {
      params = self._queue.splice(0, Math.min(self._queue.length, config.batchSize));
    } else {
      params.push(self._queue.shift());
    }

    var useBatchPath = params.length &gt; 1;

    var path = config.hostname + (useBatchPath ? config.batchPath :config.path);

    self._log(count++ + ": " + JSON.stringify(params));

    var options = _.extend({}, self.options.requestOptions, {
      body: getBody(params),
      headers: self.options.headers || {}
    });

    request.post(path, options, fn);
  }

  async.whilst(test, iterator, function (err) {
    self._log("Finished sending tracking calls")
    fn.call(self, err || null, count - 1);
  });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```javascript
var visitor = ua('UA-XXXX-XX', {https: true});
```

Tracking a pageview without much else is now very simple:

```javascript
visitor.pageview("/").<span class="apidocCodeKeywordSpan">send</span>()
```

The first argument for the pageview method is the path of the page to be tracked. Simply calling `pageview()` will not initiate
a tracking request. In order to send off tracking to the Google Analytics servers you have two options:

1. You can append a `send()` call after `pageview()`. The tracking request is sent asynchronously. This means you will not receive
 any confirmation when and if it was successful.
2. You can provide a callback function to `pageview()` as an additional, last argument. This callback will be invoked once the tracking
 request has finished. Any error that occured during the request will be provided to said callback. In that case `send()` is no
longer necessary.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.set" id="apidoc.element.universal-analytics.Visitor.prototype.set">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>set
        <span class="apidocSignatureSpan">(key, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (key, value) {
  this._persistentParams = this._persistentParams || {};
  this._persistentParams[key] = value;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


# Setting persistent parameters

Some parameters should be in every tracking call, such as a user ID or custom dimensions that never or hardly change. For such situations
 a `#set(key, value)` method is available

```javascript
  visitor.<span class="apidocCodeKeywordSpan">set</span>("uid", "123456789")
```

The uid parameter will be part of every tracking request of that visitor from now on.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.t" id="apidoc.element.universal-analytics.Visitor.prototype.t">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>t
        <span class="apidocSignatureSpan">(transaction, revenue, shipping, tax, affiliation, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">t = function (transaction, revenue, shipping, tax, affiliation, params, fn) {
  if (typeof transaction === 'object') {
    params = transaction;
    if (typeof revenue === 'function') {
      fn = revenue
    }
    transaction = revenue = shipping = tax = affiliation = null;
  } else if (typeof revenue === 'function') {
    fn = revenue;
    revenue = shipping = tax = affiliation = null;
  } else if (typeof shipping === 'function') {
    fn = shipping;
    shipping = tax = affiliation = null;
  } else if (typeof tax === 'function') {
    fn = tax;
    tax = affiliation = null;
  } else if (typeof affiliation === 'function') {
    fn = affiliation;
    affiliation = null;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.ti = transaction || params.ti || this._context.ti;
  params.tr = revenue || params.tr || this._context.tr;
  params.ts = shipping || params.ts || this._context.ts;
  params.tt = tax || params.tt || this._context.tt;
  params.ta = affiliation || params.ta || this._context.ta;
  params.p = params.p || this._context.p || this._context.dp;

  this._tidyParameters(params);

  if (!params.ti) {
    return this._handleError("Please provide at least a transaction ID (ti)", fn);
  }

  return this._withContext(params)._enqueue("transaction", params, fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.timing" id="apidoc.element.universal-analytics.Visitor.prototype.timing">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>timing
        <span class="apidocSignatureSpan">(category, variable, time, label, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timing = function (category, variable, time, label, params, fn) {

  if (typeof category === 'object') {
    params = category;
    if (typeof variable === 'function') {
      fn = variable;
    }
    category = variable = time = label = null;
  } else if (typeof variable === 'function') {
    fn = variable;
    variable = time = label = null;
  } else if (typeof time === 'function') {
    fn = time;
    time = label = null;
  } else if (typeof label === 'function') {
    fn = label;
    label = null;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.utc = category || params.utc || this._context.utc;
  params.utv = variable || params.utv || this._context.utv;
  params.utt = time || params.utt || this._context.utt;
  params.utl = label || params.utl || this._context.utl;

  this._tidyParameters(params);

  return this._withContext(params)._enqueue("timing", params, fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


## User timing tracking

Tracking user timings is a way to capture time-based information similar to the page load speed data tracked automatically by Google
 Analytics. All arguments to this tracking method are optional, but a category, a variable and a time value should be provided.
The time value should be provided in milliseconds.

```javascript
visitor.<span class="apidocCodeKeywordSpan">timing</span>("User interaction", "Time to open login overlay",
12547).send()
```

The following method signatures are available for #timing:

* `Visitor#timing(category)`
* `Visitor#timing(category, callback)`
* `Visitor#timing(category, variable)`
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.Visitor.prototype.transaction" id="apidoc.element.universal-analytics.Visitor.prototype.transaction">
        function <span class="apidocSignatureSpan">universal-analytics.Visitor.prototype.</span>transaction
        <span class="apidocSignatureSpan">(transaction, revenue, shipping, tax, affiliation, params, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">transaction = function (transaction, revenue, shipping, tax, affiliation, params, fn) {
  if (typeof transaction === 'object') {
    params = transaction;
    if (typeof revenue === 'function') {
      fn = revenue
    }
    transaction = revenue = shipping = tax = affiliation = null;
  } else if (typeof revenue === 'function') {
    fn = revenue;
    revenue = shipping = tax = affiliation = null;
  } else if (typeof shipping === 'function') {
    fn = shipping;
    shipping = tax = affiliation = null;
  } else if (typeof tax === 'function') {
    fn = tax;
    tax = affiliation = null;
  } else if (typeof affiliation === 'function') {
    fn = affiliation;
    affiliation = null;
  } else if (typeof params === 'function') {
    fn = params;
    params = null;
  }

  params = this._translateParams(params);

  params = _.extend({}, this._persistentParams || {}, params);

  params.ti = transaction || params.ti || this._context.ti;
  params.tr = revenue || params.tr || this._context.tr;
  params.ts = shipping || params.ts || this._context.ts;
  params.tt = tax || params.tt || this._context.tt;
  params.ta = affiliation || params.ta || this._context.ta;
  params.p = params.p || this._context.p || this._context.dp;

  this._tidyParameters(params);

  if (!params.ti) {
    return this._handleError("Please provide at least a transaction ID (ti)", fn);
  }

  return this._withContext(params)._enqueue("transaction", params, fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

## E-commerce tracking

E-commerce tracking in general is a bit more complex. It requires a combination of one call to the `transaction()` method and one
 or more calls to the `item()` method.

```javascript
visitor
  .<span class="apidocCodeKeywordSpan">transaction</span>("trans-12345", 500)   // Create transaction trans-12345 worth
 500 total.
  .item(300, 1, "item-54321")        // Add 1 unit the item item-54321 worth 300.
  .item(200, 2, "item-41325")        // Add 2 units the item item-41325 worth 200.
  .send()
```

Once again, daisy-chaining simplifies associating the items with the transaction. Officially, nothing but the transaction ID is
a requirement for both the transaction and the items. However, providing a minimum set of information (revenue for the transaction
, price, quantity and ID for the items) is recommended.
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.universal-analytics.utils" id="apidoc.module.universal-analytics.utils">module universal-analytics.utils</a></h1>


    <h2>
        <a href="#apidoc.element.universal-analytics.utils.ensureValidCid" id="apidoc.element.universal-analytics.utils.ensureValidCid">
        function <span class="apidocSignatureSpan">universal-analytics.utils.</span>ensureValidCid
        <span class="apidocSignatureSpan">(uuid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ensureValidCid = function (uuid) {
	if (!this.isUuid(uuid)) {
		if (!this.isCookieCid(uuid)) {
			return false;
		}
		return uuid;
	}

	uuid = uuid.replace(/\-/g, "");
	return "" +
		uuid.substring(0, 8) + "-" +
		uuid.substring(8, 12) + "-" +
		uuid.substring(12, 16) + "-" +
		uuid.substring(16, 20) + "-" +
		uuid.substring(20);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.utils.isCookieCid" id="apidoc.element.universal-analytics.utils.isCookieCid">
        function <span class="apidocSignatureSpan">universal-analytics.utils.</span>isCookieCid
        <span class="apidocSignatureSpan">(cid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isCookieCid = function (cid) {
	return /^[0-9]+\.[0-9]+$/.test(cid)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
module.exports.isCookieCid = function (cid) {
	return /^[0-9]+\.[0-9]+$/.test(cid)
}


module.exports.ensureValidCid = function (uuid) {
	if (!this.isUuid(uuid)) {
		if (!this.<span class="apidocCodeKeywordSpan">isCookieCid</span>(uuid)) {
			return false;
		}
		return uuid;
	}

	uuid = uuid.replace(/\-/g, "");
	return "" +
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.universal-analytics.utils.isUuid" id="apidoc.element.universal-analytics.utils.isUuid">
        function <span class="apidocSignatureSpan">universal-analytics.utils.</span>isUuid
        <span class="apidocSignatureSpan">(uuid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isUuid = function (uuid) {
	if (!uuid) return false;
	uuid = uuid.toString().toLowerCase();
	return /[0-9a-f]{8}\-?[0-9a-f]{4}\-?4[0-9a-f]{3}\-?[89ab][0-9a-f]{3}\-?[0-9a-f]{12}/.test(uuid)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

module.exports.isCookieCid = function (cid) {
	return /^[0-9]+\.[0-9]+$/.test(cid)
}


module.exports.ensureValidCid = function (uuid) {
	if (!this.<span class="apidocCodeKeywordSpan">isUuid</span>(uuid)) {
		if (!this.isCookieCid(uuid)) {
			return false;
		}
		return uuid;
	}

	uuid = uuid.replace(/\-/g, "");
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>